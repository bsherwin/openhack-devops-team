pipeline {
    agent any
    stages {
        stage('Install DotNet') {
            steps {
                sh "wget -q https://packages.microsoft.com/config/ubuntu/16.04/packages-microsoft-prod.deb"
                sh "sudo dpkg -i packages-microsoft-prod.deb"
                sh "sudo apt-get install apt-transport-https"
                sh "sudo apt-get update"
                sh "sudo apt-get install -y dotnet-sdk-2.1"
            }
        }
        stage('Build') {
            steps {
                dir('apis/poi') {
                    sh "ls"
                    sh "dotnet restore"
                    sh "dotnet build poi.sln"
                }
            }
        }
        stage('Test') {
            steps {
                dir('apis/poi') {
                    sh "dotnet test"
                } 
            }
        }

    }
}